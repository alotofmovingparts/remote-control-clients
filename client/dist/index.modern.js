var t,n=new Uint8Array(16);function e(){if(!t&&!(t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return t(n)}var r=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function o(t){return"string"==typeof t&&r.test(t)}for(var i=[],u=0;u<256;++u)i.push((u+256).toString(16).substr(1));function a(t,n,r){var u=(t=t||{}).random||(t.rng||e)();if(u[6]=15&u[6]|64,u[8]=63&u[8]|128,n){r=r||0;for(var a=0;a<16;++a)n[r+a]=u[a];return n}return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=(i[t[n+0]]+i[t[n+1]]+i[t[n+2]]+i[t[n+3]]+"-"+i[t[n+4]]+i[t[n+5]]+"-"+i[t[n+6]]+i[t[n+7]]+"-"+i[t[n+8]]+i[t[n+9]]+"-"+i[t[n+10]]+i[t[n+11]]+i[t[n+12]]+i[t[n+13]]+i[t[n+14]]+i[t[n+15]]).toLowerCase();if(!o(e))throw TypeError("Stringified UUID is invalid");return e}(u)}var c=function(){function t(){this.keyToValue=new Map,this.valueToKey=new Map}return t.prototype.set=function(t,n){this.keyToValue.set(t,n),this.valueToKey.set(n,t)},t.prototype.getByKey=function(t){return this.keyToValue.get(t)},t.prototype.getByValue=function(t){return this.valueToKey.get(t)},t.prototype.clear=function(){this.keyToValue.clear(),this.valueToKey.clear()},t}(),s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function f(t){var n={exports:{}};return t(n,n.exports),n.exports}var l=1e3,p=60*l,d=60*p,y=24*d,v=function(t,n){n=n||{};var e=typeof t;if("string"===e&&t.length>0)return function(t){if(!((t=String(t)).length>100)){var n=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(n){var e=parseFloat(n[1]);switch((n[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*e;case"weeks":case"week":case"w":return 6048e5*e;case"days":case"day":case"d":return e*y;case"hours":case"hour":case"hrs":case"hr":case"h":return e*d;case"minutes":case"minute":case"mins":case"min":case"m":return e*p;case"seconds":case"second":case"secs":case"sec":case"s":return e*l;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return e;default:return}}}}(t);if("number"===e&&isFinite(t))return n.long?function(t){var n=Math.abs(t);return n>=y?h(t,n,y,"day"):n>=d?h(t,n,d,"hour"):n>=p?h(t,n,p,"minute"):n>=l?h(t,n,l,"second"):t+" ms"}(t):function(t){var n=Math.abs(t);return n>=y?Math.round(t/y)+"d":n>=d?Math.round(t/d)+"h":n>=p?Math.round(t/p)+"m":n>=l?Math.round(t/l)+"s":t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function h(t,n,e,r){var o=n>=1.5*e;return Math.round(t/e)+" "+r+(o?"s":"")}var m,b=f(function(t,n){n.formatArgs=function(n){if(n[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+n[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const e="color: "+this.color;n.splice(1,0,e,"color: inherit");let r=0,o=0;n[0].replace(/%[a-zA-Z%]/g,t=>{"%%"!==t&&(r++,"%c"===t&&(o=r))}),n.splice(o,0,e)},n.save=function(t){try{t?n.storage.setItem("debug",t):n.storage.removeItem("debug")}catch(t){}},n.load=function(){let t;try{t=n.storage.getItem("debug")}catch(t){}return!t&&"undefined"!=typeof process&&"env"in process&&(t=process.env.DEBUG),t},n.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},n.storage=function(){try{return localStorage}catch(t){}}(),n.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),n.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],n.log=console.debug||console.log||(()=>{}),t.exports=function(t){function n(t){let r,o,i,u=null;function a(...t){if(!a.enabled)return;const e=a,o=Number(new Date);e.diff=o-(r||o),e.prev=r,e.curr=o,r=o,t[0]=n.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let i=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(r,o)=>{if("%%"===r)return"%";i++;const u=n.formatters[o];return"function"==typeof u&&(r=u.call(e,t[i]),t.splice(i,1),i--),r}),n.formatArgs.call(e,t),(e.log||n.log).apply(e,t)}return a.namespace=t,a.useColors=n.useColors(),a.color=n.selectColor(t),a.extend=e,a.destroy=n.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==u?u:(o!==n.namespaces&&(o=n.namespaces,i=n.enabled(t)),i),set:t=>{u=t}}),"function"==typeof n.init&&n.init(a),a}function e(t,e){const r=n(this.namespace+(void 0===e?":":e)+t);return r.log=this.log,r}function r(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return n.debug=n,n.default=n,n.coerce=function(t){return t instanceof Error?t.stack||t.message:t},n.disable=function(){const t=[...n.names.map(r),...n.skips.map(r).map(t=>"-"+t)].join(",");return n.enable(""),t},n.enable=function(t){let e;n.save(t),n.namespaces=t,n.names=[],n.skips=[];const r=("string"==typeof t?t:"").split(/[\s,]+/),o=r.length;for(e=0;e<o;e++)r[e]&&("-"===(t=r[e].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+t.substr(1)+"$")):n.names.push(new RegExp("^"+t+"$")))},n.enabled=function(t){if("*"===t[t.length-1])return!0;let e,r;for(e=0,r=n.skips.length;e<r;e++)if(n.skips[e].test(t))return!1;for(e=0,r=n.names.length;e<r;e++)if(n.names[e].test(t))return!0;return!1},n.humanize=v,n.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach(e=>{n[e]=t[e]}),n.names=[],n.skips=[],n.formatters={},n.selectColor=function(t){let e=0;for(let n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n),e|=0;return n.colors[Math.abs(e)%n.colors.length]},n.enable(n.load()),n}(n);const{formatters:e}=t.exports;e.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}})("superjson"),g=function(){function t(t){this.generateIdentifier=t,this.kv=new c}return t.prototype.register=function(t,n){if(!this.kv.getByValue(t)){if(n||(n=this.generateIdentifier(t)),"production"!==process.env.NODE_ENV){var e=this.kv.getByKey(n);e&&e!==t&&b('Ambiguous class "'+n+'", provide a unique identifier.')}this.kv.set(n,t)}},t.prototype.clear=function(){this.kv.clear()},t.prototype.getIdentifier=function(t){return this.kv.getByValue(t)},t.prototype.getValue=function(t){return this.kv.getByKey(t)},t}(),w=(m=function(t,n){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},m(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}m(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),C=new(function(t){function n(){var n=t.call(this,function(t){return t.name})||this;return n.classToAllowedProps=new Map,n}return w(n,t),n.prototype.register=function(n,e){"object"==typeof e?(e.allowProps&&this.classToAllowedProps.set(n,e.allowProps),t.prototype.register.call(this,n,e.identifier)):t.prototype.register.call(this,n,e)},n.prototype.getAllowedProps=function(t){return this.classToAllowedProps.get(t)},n}(g)),_=new g(function(t){var n;return null!==(n=t.description)&&void 0!==n?n:""});function j(t,n){Object.entries(t).forEach(function(t){var e=function(t,n){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var r,o,i=e.call(t),u=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)u.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(o)throw o.error}}return u}(t,2);return n(e[1],e[0])})}function O(t,n){return-1!==t.indexOf(n)}function E(t,n){for(var e=0;e<t.length;e++){var r=t[e];if(n(r))return r}}var k={},F=function(t){return function(t,n){var e=function(t){if("values"in Object)return Object.values(t);var n=[];for(var e in t)t.hasOwnProperty(e)&&n.push(t[e]);return n}(k);if("find"in e)return e.find(n);for(var r=e,o=0;o<r.length;o++){var i=r[o];if(n(i))return i}}(0,function(n){return n.isApplicable(t)})},A=function(t,n){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var r,o,i=e.call(t),u=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)u.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(o)throw o.error}}return u},S=function(t,n){for(var e=0,r=n.length,o=t.length;e<r;e++,o++)t[o]=n[e];return t},x=[],P=function(t){return Object.prototype.toString.call(t).slice(8,-1)},I=function(t){return void 0===t},T=function(t){return"Object"===P(t)&&(null===Object.getPrototypeOf(t)||t!==Object.prototype&&t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype)},D=function(t){return T(t)&&0===Object.keys(t).length},N=function(t){return Array.isArray(t)},R=function(t){return t instanceof Map},z=function(t){return t instanceof Set},V=function(t){return"Symbol"===P(t)},M=function(t){return"number"==typeof t&&isNaN(t)},q=function(t){return function(t){return"boolean"==typeof t}(t)||function(t){return null===t}(t)||I(t)||function(t){return"number"==typeof t&&!isNaN(t)}(t)||function(t){return"string"==typeof t}(t)||V(t)},$=function(t){return t.replace(/\./g,"\\.")},U=function(t){return t.map(String).map($).join(".")},B=function(t){for(var n=[],e="",r=0;r<t.length;r++){var o=t.charAt(r);"\\"===o&&"."===t.charAt(r+1)?(e+=".",r++):"."===o?(n.push(e),e=""):e+=o}return n.push(e),n},K=function(){return K=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},K.apply(this,arguments)},L=function(t,n){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var r,o,i=e.call(t),u=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)u.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(o)throw o.error}}return u},W=function(t,n){for(var e=0,r=n.length,o=t.length;e<r;e++,o++)t[o]=n[e];return t};function J(t,n,e,r){return{isApplicable:t,annotation:n,transform:e,untransform:r}}var G=[J(I,"undefined",function(){return null},function(){}),J(function(t){return"bigint"==typeof t},"bigint",function(t){return t.toString()},function(t){return"undefined"!=typeof BigInt?BigInt(t):(console.error("Please add a BigInt polyfill."),t)}),J(function(t){return t instanceof Date&&!isNaN(t.valueOf())},"Date",function(t){return t.toISOString()},function(t){return new Date(t)}),J(function(t){return t instanceof Error},"Error",function(t){var n={name:t.name,message:t.message};return x.forEach(function(e){n[e]=t[e]}),n},function(t){var n=new Error(t.message);return n.name=t.name,n.stack=t.stack,x.forEach(function(e){n[e]=t[e]}),n}),J(function(t){return t instanceof RegExp},"regexp",function(t){return""+t},function(t){var n=t.slice(1,t.lastIndexOf("/")),e=t.slice(t.lastIndexOf("/")+1);return new RegExp(n,e)}),J(z,"set",function(t){return W([],L(t.values()))},function(t){return new Set(t)}),J(R,"map",function(t){return W([],L(t.entries()))},function(t){return new Map(t)}),J(function(t){return M(t)||Infinity===(n=t)||-Infinity===n;var n},"number",function(t){return M(t)?"NaN":t>0?"Infinity":"-Infinity"},Number),J(function(t){return 0===t&&1/t==-Infinity},"number",function(){return"-0"},Number)];function Z(t,n,e,r){return{isApplicable:t,annotation:n,transform:e,untransform:r}}var H=Z(function(t){return!!V(t)&&!!_.getIdentifier(t)},function(t){return["symbol",_.getIdentifier(t)]},function(t){return t.description},function(t,n){var e=_.getValue(n[1]);if(!e)throw new Error("Trying to deserialize unknown symbol");return e}),Q=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,Uint8ClampedArray].reduce(function(t,n){return t[n.name]=n,t},{}),X=Z(function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},function(t){return["typed-array",t.constructor.name]},function(t){return W([],L(t))},function(t,n){var e=Q[n[1]];if(!e)throw new Error("Trying to deserialize unknown typed array");return new e(t)});function Y(t){return!!(null==t?void 0:t.constructor)&&!!C.getIdentifier(t.constructor)}var tt=Z(Y,function(t){return["class",C.getIdentifier(t.constructor)]},function(t){var n=C.getAllowedProps(t.constructor);if(!n)return K({},t);var e={};return n.forEach(function(n){e[n]=t[n]}),e},function(t,n){var e=C.getValue(n[1]);if(!e)throw new Error("Trying to deserialize unknown class - check https://github.com/blitz-js/superjson/issues/116#issuecomment-773996564");return Object.assign(Object.create(e.prototype),t)}),nt=Z(function(t){return!!F(t)},function(t){return["custom",F(t).name]},function(t){return F(t).serialize(t)},function(t,n){var e=k[n[1]];if(!e)throw new Error("Trying to deserialize unknown custom value");return e.deserialize(t)}),et=[tt,H,nt,X],rt=function(t){var n=E(et,function(n){return n.isApplicable(t)});if(n)return{value:n.transform(t),type:n.annotation(t)};var e=E(G,function(n){return n.isApplicable(t)});return e?{value:e.transform(t),type:e.annotation}:void 0},ot={};G.forEach(function(t){ot[t.annotation]=t});var it=function(t,n){for(var e=t.keys();n>0;)e.next(),n--;return e.next().value};function ut(t){if(O(t,"__proto__"))throw new Error("__proto__ is not allowed as a property");if(O(t,"prototype"))throw new Error("prototype is not allowed as a property");if(O(t,"constructor"))throw new Error("constructor is not allowed as a property")}var at=function(t,n,e){if(ut(n),0===n.length)return e(t);for(var r=t,o=0;o<n.length-1;o++){var i=n[o];if(N(r))r=r[+i];else if(T(r))r=r[i];else if(z(r))r=it(r,+i);else if(R(r)){if(o===n.length-2)break;var u=0==+n[++o]?"key":"value",a=it(r,+i);switch(u){case"key":r=a;break;case"value":r=r.get(a)}}}var c=n[n.length-1];if((N(r)||T(r))&&(r[c]=e(r[c])),z(r)){var s=it(r,+c),f=e(s);s!==f&&(r.delete(s),r.add(f))}if(R(r)){var l=it(r,+n[n.length-2]);switch(u=0==+c?"key":"value"){case"key":var p=e(l);r.set(p,r.get(l)),p!==l&&r.delete(l);break;case"value":r.set(l,e(r.get(l)))}}return t},ct=function(t,n){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var r,o,i=e.call(t),u=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)u.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(o)throw o.error}}return u},st=function(t,n){for(var e=0,r=n.length,o=t.length;e<r;e++,o++)t[o]=n[e];return t};function ft(t,n,e){if(void 0===e&&(e=[]),t)if(N(t)){var r=ct(t,2),o=r[0],i=r[1];i&&j(i,function(t,r){ft(t,n,st(st([],ct(e)),ct(B(r))))}),n(o,e)}else j(t,function(t,r){return ft(t,n,st(st([],ct(e)),ct(B(r))))})}function lt(t,n){return ft(n,function(n,e){t=at(t,e,function(t){return function(t,n){if(!N(n)){var e=ot[n];if(!e)throw new Error("Unknown transformation: "+n);return e.untransform(t)}switch(n[0]){case"symbol":return H.untransform(t,n);case"class":return tt.untransform(t,n);case"custom":return nt.untransform(t,n);case"typed-array":return X.untransform(t,n);default:throw new Error("Unknown transformation: "+n)}}(t,n)})}),t}var pt=function(t,n,e,r){var o;if(void 0===e&&(e=[]),void 0===r&&(r=[]),q(t)||function(t,n,e){var r=e.get(t);r?r.push(n):e.set(t,[n])}(t,e,n),!function(t){return T(t)||N(t)||R(t)||z(t)||Y(t)}(t)){var i=rt(t);return i?{transformedValue:i.value,annotations:[i.type]}:{transformedValue:t}}if(O(r,t))return{transformedValue:null};var u=rt(t),a=null!==(o=null==u?void 0:u.value)&&void 0!==o?o:t;q(t)||(r=st(st([],ct(r)),[t]));var c=N(a)?[]:{},s={};return j(a,function(t,o){var i=pt(t,n,st(st([],ct(e)),[o]),r);c[o]=i.transformedValue,N(i.annotations)?s[o]=i.annotations:T(i.annotations)&&j(i.annotations,function(t,n){s[$(o)+"."+n]=t})}),D(s)?{transformedValue:c,annotations:u?[u.type]:void 0}:{transformedValue:c,annotations:u?[u.type,s]:s}},dt=f(function(t,n){var e="__lodash_hash_undefined__",r=9007199254740991,o="[object Arguments]",i="[object Boolean]",u="[object Date]",a="[object Function]",c="[object GeneratorFunction]",f="[object Map]",l="[object Number]",p="[object Object]",d="[object Promise]",y="[object RegExp]",v="[object Set]",h="[object String]",m="[object Symbol]",b="[object WeakMap]",g="[object ArrayBuffer]",w="[object DataView]",C="[object Float32Array]",_="[object Float64Array]",j="[object Int8Array]",O="[object Int16Array]",E="[object Int32Array]",k="[object Uint8Array]",F="[object Uint8ClampedArray]",A="[object Uint16Array]",S="[object Uint32Array]",x=/\w*$/,P=/^\[object .+?Constructor\]$/,I=/^(?:0|[1-9]\d*)$/,T={};T[o]=T["[object Array]"]=T[g]=T[w]=T[i]=T[u]=T[C]=T[_]=T[j]=T[O]=T[E]=T[f]=T[l]=T[p]=T[y]=T[v]=T[h]=T[m]=T[k]=T[F]=T[A]=T[S]=!0,T["[object Error]"]=T[a]=T[b]=!1;var D="object"==typeof self&&self&&self.Object===Object&&self,N="object"==typeof s&&s&&s.Object===Object&&s||D||Function("return this")(),R=n&&!n.nodeType&&n,z=R&&t&&!t.nodeType&&t,V=z&&z.exports===R;function M(t,n){return t.set(n[0],n[1]),t}function q(t,n){return t.add(n),t}function $(t,n,e,r){var o=-1,i=t?t.length:0;for(r&&i&&(e=t[++o]);++o<i;)e=n(e,t[o],o,t);return e}function U(t){var n=!1;if(null!=t&&"function"!=typeof t.toString)try{n=!!(t+"")}catch(t){}return n}function B(t){var n=-1,e=Array(t.size);return t.forEach(function(t,r){e[++n]=[r,t]}),e}function K(t,n){return function(e){return t(n(e))}}function L(t){var n=-1,e=Array(t.size);return t.forEach(function(t){e[++n]=t}),e}var W,J=Array.prototype,G=Function.prototype,Z=Object.prototype,H=N["__core-js_shared__"],Q=(W=/[^.]+$/.exec(H&&H.keys&&H.keys.IE_PROTO||""))?"Symbol(src)_1."+W:"",X=G.toString,Y=Z.hasOwnProperty,tt=Z.toString,nt=RegExp("^"+X.call(Y).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),et=V?N.Buffer:void 0,rt=N.Symbol,ot=N.Uint8Array,it=K(Object.getPrototypeOf,Object),ut=Object.create,at=Z.propertyIsEnumerable,ct=J.splice,st=Object.getOwnPropertySymbols,ft=et?et.isBuffer:void 0,lt=K(Object.keys,Object),pt=Nt(N,"DataView"),dt=Nt(N,"Map"),yt=Nt(N,"Promise"),vt=Nt(N,"Set"),ht=Nt(N,"WeakMap"),mt=Nt(Object,"create"),bt=qt(pt),gt=qt(dt),wt=qt(yt),Ct=qt(vt),_t=qt(ht),jt=rt?rt.prototype:void 0,Ot=jt?jt.valueOf:void 0;function Et(t){var n=-1,e=t?t.length:0;for(this.clear();++n<e;){var r=t[n];this.set(r[0],r[1])}}function kt(t){var n=-1,e=t?t.length:0;for(this.clear();++n<e;){var r=t[n];this.set(r[0],r[1])}}function Ft(t){var n=-1,e=t?t.length:0;for(this.clear();++n<e;){var r=t[n];this.set(r[0],r[1])}}function At(t){this.__data__=new kt(t)}function St(t,n,e){var r=t[n];Y.call(t,n)&&$t(r,e)&&(void 0!==e||n in t)||(t[n]=e)}function xt(t,n){for(var e=t.length;e--;)if($t(t[e][0],n))return e;return-1}function Pt(t,n,e,r,s,d,b){var P;if(r&&(P=d?r(t,s,d,b):r(t)),void 0!==P)return P;if(!Wt(t))return t;var I=Ut(t);if(I){if(P=function(t){var n=t.length,e=t.constructor(n);return n&&"string"==typeof t[0]&&Y.call(t,"index")&&(e.index=t.index,e.input=t.input),e}(t),!n)return function(t,n){var e=-1,r=t.length;for(n||(n=Array(r));++e<r;)n[e]=t[e];return n}(t,P)}else{var D=zt(t),N=D==a||D==c;if(Kt(t))return function(t,n){if(n)return t.slice();var e=new t.constructor(t.length);return t.copy(e),e}(t,n);if(D==p||D==o||N&&!d){if(U(t))return d?t:{};if(P=function(t){return"function"!=typeof t.constructor||Mt(t)?{}:Wt(n=it(t))?ut(n):{};var n}(N?{}:t),!n)return function(t,n){return Tt(t,Rt(t),n)}(t,function(t,n){return t&&Tt(n,Jt(n),t)}(P,t))}else{if(!T[D])return d?t:{};P=function(t,n,e,r){var o=t.constructor;switch(n){case g:return It(t);case i:case u:return new o(+t);case w:return function(t,n){var e=n?It(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.byteLength)}(t,r);case C:case _:case j:case O:case E:case k:case F:case A:case S:return function(t,n){var e=n?It(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.length)}(t,r);case f:return function(t,n,e){return $(n?e(B(t),!0):B(t),M,new t.constructor)}(t,r,e);case l:case h:return new o(t);case y:return function(t){var n=new t.constructor(t.source,x.exec(t));return n.lastIndex=t.lastIndex,n}(t);case v:return function(t,n,e){return $(n?e(L(t),!0):L(t),q,new t.constructor)}(t,r,e);case m:return Ot?Object(Ot.call(t)):{}}}(t,D,Pt,n)}}b||(b=new At);var R=b.get(t);if(R)return R;if(b.set(t,P),!I)var z=e?function(t){return function(t,n,e){var r=n(t);return Ut(t)?r:function(t,n){for(var e=-1,r=n.length,o=t.length;++e<r;)t[o+e]=n[e];return t}(r,e(t))}(t,Jt,Rt)}(t):Jt(t);return function(t,n){for(var e=-1,r=t?t.length:0;++e<r&&!1!==n(t[e],e););}(z||t,function(o,i){z&&(o=t[i=o]),St(P,i,Pt(o,n,e,r,i,t,b))}),P}function It(t){var n=new t.constructor(t.byteLength);return new ot(n).set(new ot(t)),n}function Tt(t,n,e,r){e||(e={});for(var o=-1,i=n.length;++o<i;){var u=n[o],a=r?r(e[u],t[u],u,e,t):void 0;St(e,u,void 0===a?t[u]:a)}return e}function Dt(t,n){var e,r,o=t.__data__;return("string"==(r=typeof(e=n))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==e:null===e)?o["string"==typeof n?"string":"hash"]:o.map}function Nt(t,n){var e=function(t,n){return null==t?void 0:t[n]}(t,n);return function(t){return!(!Wt(t)||(n=t,Q&&Q in n))&&(Lt(t)||U(t)?nt:P).test(qt(t));var n}(e)?e:void 0}Et.prototype.clear=function(){this.__data__=mt?mt(null):{}},Et.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},Et.prototype.get=function(t){var n=this.__data__;if(mt){var r=n[t];return r===e?void 0:r}return Y.call(n,t)?n[t]:void 0},Et.prototype.has=function(t){var n=this.__data__;return mt?void 0!==n[t]:Y.call(n,t)},Et.prototype.set=function(t,n){return this.__data__[t]=mt&&void 0===n?e:n,this},kt.prototype.clear=function(){this.__data__=[]},kt.prototype.delete=function(t){var n=this.__data__,e=xt(n,t);return!(e<0||(e==n.length-1?n.pop():ct.call(n,e,1),0))},kt.prototype.get=function(t){var n=this.__data__,e=xt(n,t);return e<0?void 0:n[e][1]},kt.prototype.has=function(t){return xt(this.__data__,t)>-1},kt.prototype.set=function(t,n){var e=this.__data__,r=xt(e,t);return r<0?e.push([t,n]):e[r][1]=n,this},Ft.prototype.clear=function(){this.__data__={hash:new Et,map:new(dt||kt),string:new Et}},Ft.prototype.delete=function(t){return Dt(this,t).delete(t)},Ft.prototype.get=function(t){return Dt(this,t).get(t)},Ft.prototype.has=function(t){return Dt(this,t).has(t)},Ft.prototype.set=function(t,n){return Dt(this,t).set(t,n),this},At.prototype.clear=function(){this.__data__=new kt},At.prototype.delete=function(t){return this.__data__.delete(t)},At.prototype.get=function(t){return this.__data__.get(t)},At.prototype.has=function(t){return this.__data__.has(t)},At.prototype.set=function(t,n){var e=this.__data__;if(e instanceof kt){var r=e.__data__;if(!dt||r.length<199)return r.push([t,n]),this;e=this.__data__=new Ft(r)}return e.set(t,n),this};var Rt=st?K(st,Object):function(){return[]},zt=function(t){return tt.call(t)};function Vt(t,n){return!!(n=null==n?r:n)&&("number"==typeof t||I.test(t))&&t>-1&&t%1==0&&t<n}function Mt(t){var n=t&&t.constructor;return t===("function"==typeof n&&n.prototype||Z)}function qt(t){if(null!=t){try{return X.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function $t(t,n){return t===n||t!=t&&n!=n}(pt&&zt(new pt(new ArrayBuffer(1)))!=w||dt&&zt(new dt)!=f||yt&&zt(yt.resolve())!=d||vt&&zt(new vt)!=v||ht&&zt(new ht)!=b)&&(zt=function(t){var n=tt.call(t),e=n==p?t.constructor:void 0,r=e?qt(e):void 0;if(r)switch(r){case bt:return w;case gt:return f;case wt:return d;case Ct:return v;case _t:return b}return n});var Ut=Array.isArray;function Bt(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}(t.length)&&!Lt(t)}var Kt=ft||function(){return!1};function Lt(t){var n=Wt(t)?tt.call(t):"";return n==a||n==c}function Wt(t){var n=typeof t;return!!t&&("object"==n||"function"==n)}function Jt(t){return Bt(t)?function(t,n){var e=Ut(t)||function(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&Bt(t)}(t)&&Y.call(t,"callee")&&(!at.call(t,"callee")||tt.call(t)==o)}(t)?function(t,n){for(var e=-1,r=Array(t);++e<t;)r[e]=n(e);return r}(t.length,String):[],r=e.length,i=!!r;for(var u in t)!Y.call(t,u)||i&&("length"==u||Vt(u,r))||e.push(u);return e}(t):function(t){if(!Mt(t))return lt(t);var n=[];for(var e in Object(t))Y.call(t,e)&&"constructor"!=e&&n.push(e);return n}(t)}t.exports=function(t){return Pt(t,!0,!0)}}),yt=function(){return yt=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},yt.apply(this,arguments)},vt=function(t){var n=new Map,e=pt(t,n),r={json:e.transformedValue};e.annotations&&(r.meta=yt(yt({},r.meta),{values:e.annotations}));var o,i,u=(o={},i=void 0,n.forEach(function(t){if(!(t.length<=1)){var n=ct(t.map(function(t){return t.map(String)}).sort(function(t,n){return t.length-n.length})),e=n[0],r=n.slice(1);0===e.length?i=r.map(U):o[U(e)]=r.map(U)}}),i?D(o)?[i]:[i,o]:D(o)?void 0:o);return u&&(r.meta=yt(yt({},r.meta),{referentialEqualities:u})),r},ht=function(t){var n=t.meta,e=dt(t.json);return(null==n?void 0:n.values)&&(e=lt(e,n.values)),(null==n?void 0:n.referentialEqualities)&&(e=function(t,n){function e(n,e){var r=function(t,n){return ut(n),n.forEach(function(n){t=t[n]}),t}(t,B(e));n.map(B).forEach(function(n){t=at(t,n,function(){return r})})}if(N(n)){var r=ct(n,2),o=r[1];r[0].forEach(function(n){t=at(t,B(n),function(){return t})}),o&&j(o,e)}else j(n,e);return t}(e,n.referentialEqualities)),e},mt={stringify:function(t){return JSON.stringify(vt(t))},parse:function(t){return ht(JSON.parse(t))},serialize:vt,deserialize:ht,registerClass:function(t,n){return C.register(t,n)},registerSymbol:function(t,n){return _.register(t,n)},registerCustom:function(t,n){return function(t){k[t.name]=t}(yt({name:n},t))},allowErrorProps:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];x.push.apply(x,S([],A(t)))}};function bt(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function gt(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),e.push.apply(e,r)}return e}function wt(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?gt(Object(e),!0).forEach(function(n){bt(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):gt(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function Ct(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function _t(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function jt(t,n){return jt=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t},jt(t,n)}function Ot(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&jt(t,n)}function Et(t){return Et=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Et(t)}function kt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function Ft(t){return Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ft(t)}function At(t,n){if(n&&("object"===Ft(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return _t(t)}function St(t){var n=kt();return function(){var e,r=Et(t);if(n){var o=Et(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return At(this,e)}}function xt(t,n,e){return xt=kt()?Reflect.construct:function(t,n,e){var r=[null];r.push.apply(r,n);var o=new(Function.bind.apply(t,r));return e&&jt(o,e.prototype),o},xt.apply(null,arguments)}function Pt(t){var n="function"==typeof Map?new Map:void 0;return Pt=function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return xt(t,arguments,Et(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),jt(e,t)},Pt(t)}function It(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Tt(t,n,e){return n&&It(t.prototype,n),e&&It(t,e),t}var Dt=/*#__PURE__*/function(t){Ot(e,/*#__PURE__*/Pt(Error));var n=/*#__PURE__*/St(e);function e(t,r){var o,i,u,a,c;Ct(this,e);var s=null!==(o=r.cause)&&void 0!==o?o:r.originalError;return(c=n.call(this,t,{cause:s})).originalError=void 0,c.cause=void 0,c.shape=void 0,c.data=void 0,c.isDone=void 0,c.isDone=null!==(i=r.isDone)&&void 0!==i&&i,c.cause=c.originalError=s,c.shape=null===(u=r.result)||void 0===u?void 0:u.error,c.data=null===(a=r.result)||void 0===a?void 0:a.error.data,c.name="TRPCClientError",Object.setPrototypeOf(_t(c),e.prototype),c}return Tt(e,null,[{key:"from",value:function(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t instanceof Error?"TRPCClientError"===t.name?t:new e(t.message,wt(wt({},r),{},{cause:t,result:null})):new e(null!==(n=t.error.message)&&void 0!==n?n:"",wt(wt({},r),{},{cause:null,result:t}))}}]),e}(),Nt=function(t){return 0===t?0:Math.min(1e3*Math.pow(2,t),3e4)};function Rt(t){var n=t.url,e=t.WebSocket,r=void 0===e?WebSocket:e,o=t.retryDelayMs,i=void 0===o?Nt:o;if(!r)throw new Error("No WebSocket implementation found - you probably don't want to use this on the server, but if you do you need to pass a `WebSocket`-ponyfill");var u=[],a=Object.create(null),c=0,s=null,f=null,l=b(),p="connecting";function d(){"open"!==p||s||(s=setTimeout(function(){s=null,l.send(1===u.length?JSON.stringify(u.pop()):JSON.stringify(u)),u=[]}))}function y(){f||"closed"===p||function(t){f||(p="connecting",f=setTimeout(v,t))}(i(c++))}function v(){p="connecting";var t=l;l=b(),h(t)}function h(t){Object.values(a).some(function(n){return n.ws===t})||t.close()}function m(t){u.some(function(n){return n.id===t.op.id})||g(t.op,t.callbacks)}function b(){var t=new WebSocket(n);return clearTimeout(f),f=null,t.addEventListener("open",function(){t===l&&(c=0,p="open",d())}),t.addEventListener("error",function(){t===l&&y()}),t.addEventListener("message",function(n){var e=JSON.parse(n.data);"method"in e?function(n){if("reconnect"===n.method&&t===l){v();for(var e=0,r=Object.values(a);e<r.length;e++){var o=r[e];"subscription"===o.type&&m(o)}}}(e):function(n){var e,r,o=null!==n.id&&a[n.id];if(o)if("error"in n){var i,u;null===(i=(u=o.callbacks).onError)||void 0===i||i.call(u,n)}else{if(null===(e=(r=o.callbacks).onNext)||void 0===e||e.call(r,n.result),o.ws!==l&&t===l){var c=o.ws;o.ws=l,h(c)}var s,f;"stopped"===n.result.type&&t===l&&(null===(s=(f=o.callbacks).onDone)||void 0===s||s.call(f))}}(e),t===l&&"closed"!==p||h(t)}),t.addEventListener("close",function(){for(var n in l===t&&y(),a){var e,r,o,i,u=a[n];u.ws===t&&(null===(e=(r=u.callbacks).onError)||void 0===e||e.call(r,Dt.from(new zt("WebSocket closed prematurely"))),"subscription"!==u.type?(delete a[n],null===(o=(i=u.callbacks).onDone)||void 0===o||o.call(i)):"closed"!==p&&m(u))}}),t}function g(t,n){var e=t.type,r=t.id,o={id:r,jsonrpc:"2.0",method:e,params:{input:t.input,path:t.path}};return a[r]={ws:l,type:e,callbacks:n,op:t},u.push(o),d(),function(){var n,e,o=null===(n=a[r])||void 0===n?void 0:n.callbacks;delete a[r],u=u.filter(function(t){return t.id!==r}),null==o||null===(e=o.onDone)||void 0===e||e.call(o),"subscription"===t.type&&(u.push({id:r,method:"subscription.stop",params:void 0}),d())}}return{close:function(){p="closed",h(l)},request:g,getConnection:function(){return l}}}var zt=/*#__PURE__*/function(t){Ot(e,/*#__PURE__*/Pt(Error));var n=/*#__PURE__*/St(e);function e(t){var r;return Ct(this,e),(r=n.call(this,t)).name="TRPCWebSocketClosedError",Object.setPrototypeOf(_t(r),e.prototype),r}return e}(),Vt=/*#__PURE__*/function(t){Ot(e,/*#__PURE__*/Pt(Error));var n=/*#__PURE__*/St(e);function e(t){var r;return Ct(this,e),(r=n.call(this,t)).name="TRPCSubscriptionEndedError",Object.setPrototypeOf(_t(r),e.prototype),r}return e}();function Mt(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function qt(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(t){if("string"==typeof t)return Mt(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Mt(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,a=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return u=t.done,t},e:function(t){a=!0,i=t},f:function(){try{u||null==e.return||e.return()}finally{if(a)throw i}}}}var $t=/*#__PURE__*/function(t){Ot(e,/*#__PURE__*/Pt(Error));var n=/*#__PURE__*/St(e);function e(){var t;return Ct(this,e),(t=n.call(this,"The operation was aborted.")).name="TRPCAbortError",Object.setPrototypeOf(_t(t),e.prototype),t}return e}();function Ut(t){var n=null,e=null,r=function(){clearTimeout(e),e=null,n=null};function o(){var e=n;r();var o=t(e.items.map(function(t){return t.key})),i=o.promise;e.cancel=o.cancel,i.then(function(t){for(var n=0;n<t.length;n++)e.items[n].resolve(t[n])}).catch(function(t){var n,r=qt(e.items);try{for(r.s();!(n=r.n()).done;)n.value.reject(t)}catch(t){r.e(t)}finally{r.f()}})}return{load:function(t){var i={cancelled:!1,key:t};n||(n={items:[],cancel:function(){r()}});var u=n,a=new Promise(function(t,n){var e=i;e.reject=n,e.resolve=t,u.items.push(e)});return e||(e=setTimeout(o)),{promise:a,cancel:function(){i.cancelled=!0,u.items.some(function(t){return!t.cancelled})||u.cancel()}}}}}function Bt(t){var n=t.url;return function(t){var e=function(e){return function(r){var o=r.map(function(t){return t.path}).join(","),i=r.map(function(t){return t.input}),u=function(t){var n=t.type,e=t.runtime,r=t.path,o=e.AbortController?new e.AbortController:null,i={query:"GET",mutation:"POST",subscription:"PATCH"},u="input"in t?e.transformer.serialize(t.input):function(t){for(var n={},e=0;e<t.length;e++)n[e]=t[e];return n}(t.inputs.map(function(t){return e.transformer.serialize(t)}));function a(){if("query"!==n)return void 0!==u?JSON.stringify(u):void 0}return{promise:new Promise(function(c,s){var f=function(){var e=t.url+"/"+r,o=[];return"inputs"in t&&o.push("batch=1"),"query"===n&&void 0!==u&&o.push("input=".concat(encodeURIComponent(JSON.stringify(u)))),o.length&&(e+="?"+o.join("&")),e}();Promise.resolve(e.headers()).then(function(t){return e.fetch(f,{method:i[n],signal:null==o?void 0:o.signal,body:a(),headers:wt({"content-type":"application/json"},t)})}).then(function(t){return t.json()}).then(function(t){c(t)}).catch(s)}),cancel:function(){null==o||o.abort()}}}({url:n,inputs:i,path:o,runtime:t,type:e}),a=u.cancel;return{promise:u.promise.then(function(t){return Array.isArray(t)?t:r.map(function(){return t})}),cancel:a}}},r=Ut(e("query")),o=Ut(e("mutation")),i={query:r,subscription:Ut(e("subscription")),mutation:o};return function(n){var e=n.op,r=n.prev,o=n.onDestroy,u=i[e.type].load(e),a=u.promise,c=u.cancel,s=!1,f=function(t){s||(s=!0,r(t))};o(function(){f(Dt.from(new $t,{isDone:!0})),c()}),a.then(function(n){f(function(t){var n=t.envelope,e=t.runtime;return"error"in n?Dt.from(wt(wt({},n),{},{error:e.transformer.deserialize(n.error)})):"data"===n.result.type?wt(wt({},n.result),{},{data:e.transformer.deserialize(n.result.data)}):n.result}({envelope:n,runtime:t}))}).catch(function(t){f(Dt.from(t))})}}}function Kt(){return"undefined"!=typeof window?window:global}var Lt=0,Wt=/*#__PURE__*/function(){function t(n){var e=this;Ct(this,t),this.links=void 0,this.runtime=void 0;var r,o,i=n.transformer?"input"in n.transformer?{serialize:n.transformer.input.serialize,deserialize:n.transformer.output.deserialize}:n.transformer:{serialize:function(t){return t},deserialize:function(t){return t}},u=function(t){if(t)return t;var n=Kt();if(n.fetch)return"function"==typeof n.fetch.bind?n.fetch.bind(n):n.fetch;throw new Error("No fetch implementation found")}(null==n?void 0:n.fetch),a=(r=null==n?void 0:n.AbortController,o=Kt(),r||o.AbortController||null);this.runtime={transformer:i,AbortController:a,fetch:u,headers:function(){if(n.headers){var t=n.headers;return"function"==typeof t?t:function(){return t}}return function(){return{}}}()},this.links="links"in n?n.links.map(function(t){return t(e.runtime)}):[Bt({url:n.url})(this.runtime)]}return Tt(t,[{key:"$request",value:function(t){var n,e,r,o,i=t.context;return n={links:this.links,op:{id:++Lt,type:t.type,path:t.path,input:t.input,context:void 0===i?{}:i}},e=function(){var t=[],n=null;return{subscribe:function(n){var e={callbacks:n,unsubscribe:function(){var n,r,o=t.indexOf(e);-1!==o&&(t.splice(o,1),null===(n=(r=e.callbacks).onDone)||void 0===n||n.call(r))}};return t.push(e),function(){e.unsubscribe()}},next:function(e){var r=n;if(n=e,r!==e){var o,i=qt(t);try{for(i.s();!(o=i.n()).done;){var u,a;null===(u=(a=o.value.callbacks).onNext)||void 0===u||u.call(a,e)}}catch(t){i.e(t)}finally{i.f()}}},done:function(){for(;t.length;){var n,e,r=t.pop();null==r||null===(n=(e=r.callbacks).onDone)||void 0===n||n.call(e),null==r||r.unsubscribe()}},error:function(t){function n(n){return t.apply(this,arguments)}return n.toString=function(){return t.toString()},n}(function(n){var e,r=qt(t);try{for(r.s();!(e=r.n()).done;){var o,i;null===(o=(i=e.value.callbacks).onError)||void 0===o||o.call(i,n)}}catch(t){r.e(t)}finally{r.f()}})}}(),r=null,e.next(null),o=wt(wt({},e),{},{next:function(t){r=t,e.next(t)},get:function(){return r}}),function t(e){var r=e.index,i=e.stack;(0,n.links[r])({op:e.op,prev:0===r?function(t){var n;(n=t)instanceof Error?(o.error(n),n.isDone&&o.done()):o.next(n)}:i[r-1],next:function(n,e){var o=i.slice();o[r]=e,t({index:r+1,op:n,stack:o})},onDestroy:function(t){o.subscribe({onDone:function(){t()}})}})}({index:0,op:n.op,stack:[]}),o}},{key:"requestAsPromise",value:function(t){var n=this.$request(t),e=new Promise(function(t,e){var r=n.get();if("data"===(null==r?void 0:r.type))return t(r.data),void n.done();n.subscribe({onNext:function(e){"data"===(null==e?void 0:e.type)&&(t(e.data),n.done())},onError:function(t){e(t),n.done()},onDone:function(){e(Dt.from(new $t))}})});return e.cancel=function(){n.done()},e}},{key:"query",value:function(t){var n,e=null===(n=arguments.length<=2?void 0:arguments[2])||void 0===n?void 0:n.context;return this.requestAsPromise({type:"query",path:t,input:arguments.length<=1?void 0:arguments[1],context:e})}},{key:"mutation",value:function(t){var n,e=null===(n=arguments.length<=2?void 0:arguments[2])||void 0===n?void 0:n.context;return this.requestAsPromise({type:"mutation",path:t,input:arguments.length<=1?void 0:arguments[1],context:e})}},{key:"subscription",value:function(t,n,e){var r=this.$request({type:"subscription",path:t,input:n,context:e.context});return r.subscribe({onNext:function(t){var n;t&&(null===(n=e.onNext)||void 0===n||n.call(e,t))},onError:function(t){var n;null===(n=e.onError)||void 0===n||n.call(e,t)},onDone:e.onDone}),function(){r.done()}}}]),t}();class Jt{constructor(t){if(this.uuid=void 0,this.channelKey=void 0,this.trpcClient=void 0,"object"!=typeof t)throw new Error("RCClient: options required");if("string"!=typeof t.hostname||""===t.hostname||t.hostname.startsWith("http"))throw new Error("RCClient: 'hostname' required, e.g. 'example.com'");if("string"!=typeof t.channelKey||!new RegExp("^[A-Za-z0-9-_.~]*$").test(t.channelKey))throw new Error("RCClient: 'channelKey' required, e.g. 'abcdefghij_0123456789'");const{hostname:n,channelKey:e,secure:r=!0}=t;this.uuid=a(),this.channelKey=e;const o=new URL("/api/trpc",`${r?"https":"http"}://${n}`).toString(),i=function(t){return function(n){var e=t.client;return function(t){var r=t.op,o=t.prev,i=t.onDestroy,u=r.type,a=r.path,c=r.id,s=n.transformer.serialize(r.input),f=!1,l=e.request({type:u,path:a,input:s,id:c},{onNext:function(t){if(!f){if("data"in t){var e=n.transformer.deserialize(t.data);o({type:"data",data:e})}else o(t);"subscription"!==r.type&&(f=!0,l())}},onError:function(t){f||o(t instanceof Error?t:Dt.from(wt(wt({},t),{},{error:n.transformer.deserialize(t.error)})))},onDone:function(){if(!f){var t=new Vt("Operation ended prematurely");o(Dt.from(t,{isDone:!0})),f=!0}}});i(function(){f=!0,l()})}}}({client:Rt({url:`${r?"wss":"ws"}://${n}`})});this.trpcClient=function(t){return new Wt(t)}({url:o,links:[i],transformer:mt})}async update(t,n){try{await this.trpcClient.mutation("channel.update",{key:this.channelKey,data:{data:t},uuid:this.uuid}),n&&n(null)}catch(t){n&&n(t)}}subscribe(t){return this.trpcClient.subscription("channel.onUpdate",{key:this.channelKey,uuid:this.uuid},{onNext:n=>{"data"===n.type&&t(null,n.data.data)},onError:n=>t(n)})}async read(t){try{t(null,(await this.trpcClient.query("channel.read",this.channelKey)).data)}catch(n){t(n)}}}export{Jt as default};
//# sourceMappingURL=index.modern.js.map
